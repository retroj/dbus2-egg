;;;; dbus.setup -*- Scheme -*-

(use files utils)

(make (("dbus.import.so" ("dbus.c")
	(compile -s -O3 -d0 dbus.import.scm))
       ("dbus.so" ("dbus.c")
	(compile -s -O3 -d1 dbus.scm ,(with-input-from-pipe "pkg-config --cflags dbus-1" read-line) -ldbus-1))
       ("dbus.c" ("dbus.scm")
	(compile -t dbus.scm -O3 -d1 -X easyffi -C -g -j dbus)))
 '("dbus.so" "dbus.import.so"))

(install-extension 'dbus
		   `("dbus.so" "dbus.import.so")
		   `((version 0.88)))

